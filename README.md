# NagaAgent 3.0

> æ™ºèƒ½å¯¹è¯åŠ©æ‰‹ï¼Œæ”¯æŒå¤šMCPæœåŠ¡ã€æµå¼è¯­éŸ³äº¤äº’ã€GRAGçŸ¥è¯†å›¾è°±è®°å¿†ç³»ç»Ÿã€RESTful APIæ¥å£ã€æ§åˆ¶å°æ‰˜ç›˜åŠŸèƒ½ã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®
```bash
git clone [é¡¹ç›®åœ°å€]
cd NagaAgent3.0
```

### 2. ä¸€é”®é…ç½®

**Windows:**

```powershell
.\setup.ps1
```

**Mac:**
```bash
chmod +x setup_mac.sh
./setup_mac.sh
```

### 3.å¯åŠ¨neo4j dockeræœåŠ¡

#### 1.å®‰è£…docker

**Windows:**

ä¸‹è½½[https://desktop.docker.com/win/main/amd64/Docker%20Desktop%20Installer.exe](https://desktop.docker.com/win/main/amd64/Docker%20Desktop%20Installer.exe)å¹¶å®‰è£…

**å…¶å®ƒç³»ç»Ÿ:**

è¯·è‡ªè¡Œæœç´¢å®‰è£…æ–¹å¼

#### 2.å¯åŠ¨neo4jé•œåƒæœåŠ¡

```
docker run -d --restart always --publish=7474:7474 --publish=7687:7687 --env NEO4J_AUTH=neo4j/your_password --volume=/path/to/your/data:/data neo4j
```

å¦‚æœå¯åŠ¨å¤±è´¥å¯ä»¥æ›´æ¢ç«¯å£ä¾‹å¦‚ï¼š

```
--publish=8474:7474 --publish=8687:7687
```

### 4.å¤åˆ¶config.json.exampleä¸ºconfig.jsonå¹¶ä¸”æ ¹æ®æ³¨é‡Šä¿®æ”¹å‚æ•°

### 5. å¯åŠ¨åº”ç”¨

**Windows (æ™®é€šæ¨¡å¼):**
```powershell
.\start.bat
```

**Windows (æ‰˜ç›˜æ¨¡å¼):**
```powershell
.\start_with_tray.bat
```

**Mac:**
```bash
./start_mac.sh
```

å¯åŠ¨åå°†è‡ªåŠ¨å¼€å¯PyQt5ç•Œé¢å’ŒRESTful APIæœåŠ¡å™¨ï¼Œå¯åŒæ—¶ä½¿ç”¨ç•Œé¢å¯¹è¯å’ŒAPIæ¥å£ã€‚

---

## ğŸ–¥ï¸ ç³»ç»Ÿè¦æ±‚
- **Windows:** Windows 10/11 + PowerShell 5.1+
- **Mac:** macOS 10.15 (Catalina) æˆ–æ›´é«˜ç‰ˆæœ¬ + Homebrew
- **é€šç”¨:** Python 3.10+ (æ¨è 3.11)

---

## ğŸ› ï¸ ä¾èµ–å®‰è£…ä¸ç¯å¢ƒé…ç½®

### Windows ç¯å¢ƒ
- æ‰€æœ‰ä¾èµ–è§`requirements.txt`
- æ¨èä½¿ç”¨è™šæ‹Ÿç¯å¢ƒï¼š`python -m venv .venv`
- å¦‚é‡`greenlet`ã€`pyaudio`ç­‰å®‰è£…å¤±è´¥ï¼Œéœ€å…ˆè£…[Microsoft Visual C++ Build Tools](https://visualstudio.microsoft.com/visual-cpp-build-tools/)
- æµè§ˆå™¨è‡ªåŠ¨åŒ–éœ€`playwright`ï¼Œé¦–æ¬¡ç”¨éœ€`python -m playwright install chromium`
- MCPå·¥å…·ä¾èµ–ï¼š`jmcomic`ã€`fastmcp`

**ä¾èµ–å®‰è£…å‘½ä»¤ï¼š**
```powershell
# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
.venv\Scripts\Activate.ps1

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å®‰è£…æµè§ˆå™¨é©±åŠ¨
python -m playwright install chromium

# å®‰è£…MCPå·¥å…·ä¾èµ–
pip install jmcomic fastmcp
```

### Mac ç¯å¢ƒ
- ç³»ç»Ÿä¾èµ–é€šè¿‡Homebrewå®‰è£…ï¼š
  ```bash
  brew install python@3.11 portaudio
  brew install --cask google-chrome
  ```
- Pythonä¾èµ–å®‰è£…ï¼š
  ```bash
  python3 -m venv .venv
  source .venv/bin/activate
  pip install -r requirements.txt
  python -m playwright install chromium
  ```

### ç¯å¢ƒæ£€æŸ¥
```bash
python check_env.py
```

### è§£å†³å¸¸è§è­¦å‘Š

### Numpy built with MINGW-W64 on Windows 64 bits is experimental é”™è¯¯

å¦‚æœå‡ºç°å¦‚ä¸‹é”™è¯¯ï¼š

```
<frozen importlib._bootstrap>:488: Warning: Numpy built with MINGW-W64 on Windows 64 bits is experimental, and only available for
testing. You are advised not to use it for production.
```

è¯·å®‰è£…Visual Studioæœ€æ–°ç‰ˆå¹¶ä¸”è¿›å…¥Developer Command Prompt For VSä¾æ¬¡æ‰§è¡Œï¼š

```bash
uv pip uninstall numpy
uv sync --no-cache
```

---

## âš™ï¸ é…ç½®è¯´æ˜

### API é…ç½®
ä¿®æ”¹ `config.json` æ–‡ä»¶ä¸­çš„ `api` éƒ¨åˆ†ï¼š
```json
{
  "api": {
    "api_key": "your-api-key-here",
    "base_url": "https://api.deepseek.com/v1",
    "model": "deepseek-chat",
    "temperature": 0.7,
    "max_tokens": 2000,
    "max_history_rounds": 10
  }
}
```

### APIæœåŠ¡å™¨é…ç½®
```json
{
  "api_server": {
    "enabled": true,
    "host": "127.0.0.1",
    "port": 8000,
    "auto_start": true,
    "docs_enabled": true
  }
}
```

### GRAGçŸ¥è¯†å›¾è°±è®°å¿†ç³»ç»Ÿé…ç½®
```json
{
  "grag": {
    "enabled": true,
    "auto_extract": true,
    "context_length": 5,
    "similarity_threshold": 0.6,
    "neo4j_uri": "neo4j://127.0.0.1:7687",
    "neo4j_user": "neo4j",
    "neo4j_password": "your_password",
    "neo4j_database": "neo4j"
  }
}
```

### è·å– API å¯†é’¥
1. è®¿é—®å¯¹åº”çš„LLMæœåŠ¡å•†å®˜ç½‘ï¼ˆå¦‚DeepSeekã€OpenAIç­‰ï¼‰
2. æ³¨å†Œè´¦å·å¹¶åˆ›å»º API å¯†é’¥
3. å°†å¯†é’¥å¡«å…¥ `config.json` æ–‡ä»¶çš„ `api.api_key` å­—æ®µ

---

## ğŸŒŸ ä¸»è¦ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½
- **å…¨å±€é…ç½®ç®¡ç†**: æ‰€æœ‰å˜é‡ç»Ÿä¸€åœ¨`config.py`ç®¡ç†ï¼Œæ”¯æŒ.envå’Œç¯å¢ƒå˜é‡
- **RESTful APIæ¥å£**: è‡ªåŠ¨å¯åŠ¨HTTPæœåŠ¡å™¨ï¼Œæ”¯æŒå®Œæ•´å¯¹è¯åŠŸèƒ½å’Œæµå¼è¾“å‡º
- **GRAGçŸ¥è¯†å›¾è°±è®°å¿†ç³»ç»Ÿ**: åŸºäºNeo4jçš„äº”å…ƒç»„çŸ¥è¯†å›¾è°±ï¼Œè‡ªåŠ¨æå–å¯¹è¯ä¸­çš„å®ä½“å…³ç³»
- **HANDOFFå·¥å…·è°ƒç”¨å¾ªç¯**: è‡ªåŠ¨è§£æå’Œæ‰§è¡ŒLLMè¿”å›çš„å·¥å…·è°ƒç”¨ï¼Œæ”¯æŒå¤šè½®é€’å½’è°ƒç”¨
- **å¤šAgentèƒ½åŠ›æ‰©å±•**: æµè§ˆå™¨ã€æ–‡ä»¶ã€ä»£ç ç­‰å¤šç§Agentå³æ’å³ç”¨
- **è·¨å¹³å°å…¼å®¹**: Windows/Macè‡ªåŠ¨é€‚é…ï¼Œæµè§ˆå™¨è·¯å¾„è‡ªåŠ¨æ£€æµ‹

### è¯­éŸ³äº¤äº’
- **æµå¼è¯­éŸ³äº¤äº’**: åŸºäºEdge-TTSçš„OpenAIå…¼å®¹è¯­éŸ³åˆæˆ
- **æ™ºèƒ½åˆ†å¥**: æ”¯æŒpygameåå°ç›´æ¥æ’­æ”¾å’Œæ™ºèƒ½åˆ†å¥
- **å¼‚æ­¥å¤„ç†**: æ–‡æœ¬æ˜¾ç¤ºå’ŒéŸ³é¢‘æ’­æ”¾å®Œå…¨åˆ†ç¦»

### UIç•Œé¢
- **PyQt5åŠ¨ç”»ä¸UI**: æ”¯æŒPNGåºåˆ—å¸§ï¼ŒloadingåŠ¨ç”»æå¿«
- **Markdownæ”¯æŒ**: èŠå¤©çª—å£æ”¯æŒMarkdownè¯­æ³•ï¼ŒåŒ…æ‹¬æ ‡é¢˜ã€ç²—ä½“ã€æ–œä½“ã€ä»£ç å—ã€è¡¨æ ¼ç­‰
- **ä¸»é¢˜è‡ªå®šä¹‰**: èŠå¤©çª—å£èƒŒæ™¯é€æ˜åº¦ã€ç”¨æˆ·åã€ä¸»é¢˜æ ‘å¬å›ç­‰å…¨éƒ¨å¯è‡ªå®šä¹‰

### ç³»ç»Ÿæ‰˜ç›˜åŠŸèƒ½
- **æ§åˆ¶å°æ‰˜ç›˜**: ä½¿ç”¨`start_with_tray.bat`å¯åŠ¨ï¼Œå¯å°†ç»ˆç«¯çª—å£éšè—åˆ°ç³»ç»Ÿæ‰˜ç›˜
- **è‡ªåŠ¨éšè—**: å¯åŠ¨å3ç§’è‡ªåŠ¨éšè—æ§åˆ¶å°çª—å£
- **ä»»åŠ¡æ éšè—**: æ§åˆ¶å°çª—å£ä»ä»»åŠ¡æ å®Œå…¨éšè—
- **æ‰˜ç›˜æ“ä½œ**: å³é”®æ‰˜ç›˜å›¾æ ‡æŸ¥çœ‹èœå•ï¼ŒåŒå‡»æ˜¾ç¤ºçª—å£
- **è‡ªå¯åŠ¨ç®¡ç†**: æ”¯æŒæ³¨å†Œè¡¨æ–¹å¼çš„è‡ªå¯åŠ¨åŠŸèƒ½

### Agentç³»ç»Ÿ
- **åŠ¨æ€æœåŠ¡æ± æŸ¥è¯¢**: ç³»ç»Ÿé€šè¿‡æ‰«æ`agent-manifest.json`æ–‡ä»¶è‡ªåŠ¨å‘ç°å’Œæ³¨å†ŒæœåŠ¡
- **AgentManagerç‹¬ç«‹ç³»ç»Ÿ**: æ”¯æŒAgentçš„é…ç½®åŠ è½½ã€ä¼šè¯ç®¡ç†ã€æ¶ˆæ¯ç»„è£…å’ŒLLMè°ƒç”¨
- **æ™ºèƒ½å ä½ç¬¦æ›¿æ¢**: æ”¯æŒAgenté…ç½®ã€ç¯å¢ƒå˜é‡ã€æ—¶é—´ä¿¡æ¯ç­‰å¤šç§å ä½ç¬¦
- **ä¼šè¯éš”ç¦»ä¸TTLç®¡ç†**: æ”¯æŒå¤šç”¨æˆ·å¤šä¼šè¯éš”ç¦»ï¼Œè‡ªåŠ¨æ¸…ç†è¿‡æœŸä¼šè¯æ•°æ®

---

## ğŸ—‚ï¸ ç›®å½•ç»“æ„
```
NagaAgent3.0/
â”œâ”€â”€ main.py                     # ä¸»å…¥å£
â”œâ”€â”€ config.py                   # å…¨å±€é…ç½®
â”œâ”€â”€ conversation_core.py        # å¯¹è¯æ ¸å¿ƒï¼ˆå«å·¥å…·è°ƒç”¨å¾ªç¯ä¸»é€»è¾‘ï¼‰
â”œâ”€â”€ apiserver/                  # APIæœåŠ¡å™¨æ¨¡å—
â”‚   â”œâ”€â”€ api_server.py           # FastAPIæœåŠ¡å™¨
â”‚   â”œâ”€â”€ start_server.py         # å¯åŠ¨è„šæœ¬
â”‚   â””â”€â”€ README.md               # APIæ–‡æ¡£
â”œâ”€â”€ mcpserver/
â”‚   â”œâ”€â”€ mcp_manager.py          # MCPæœåŠ¡ç®¡ç†
â”‚   â”œâ”€â”€ mcp_registry.py         # Agentæ³¨å†Œä¸schemaå…ƒæ•°æ®
â”‚   â”œâ”€â”€ agent_manager.py        # Agentç®¡ç†å™¨ï¼ˆç‹¬ç«‹ç³»ç»Ÿï¼‰
â”‚   â”œâ”€â”€ agent_xxx/              # å„ç±»è‡ªå®šä¹‰Agent
â”‚   â”‚   â””â”€â”€ agent-manifest.json # Agenté…ç½®æ–‡ä»¶
â”œâ”€â”€ agent_configs/              # Agenté…ç½®æ–‡ä»¶ç›®å½•
â”‚   â””â”€â”€ *.json                  # Agenté…ç½®æ–‡ä»¶
â”œâ”€â”€ requirements.txt             # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ setup.ps1                   # Windowsé…ç½®è„šæœ¬
â”œâ”€â”€ start.bat                   # Windowså¯åŠ¨è„šæœ¬
â”œâ”€â”€ start_with_tray.bat         # Windowsæ‰˜ç›˜å¯åŠ¨è„šæœ¬
â”œâ”€â”€ setup_mac.sh                # Macé…ç½®è„šæœ¬
â”œâ”€â”€ check_env.py                # è·¨å¹³å°ç¯å¢ƒæ£€æŸ¥
â”œâ”€â”€ summer_memory/              # GRAGçŸ¥è¯†å›¾è°±è®°å¿†ç³»ç»Ÿ
â”‚   â”œâ”€â”€ memory_manager.py       # è®°å¿†ç®¡ç†å™¨
â”‚   â”œâ”€â”€ quintuple_extractor.py  # äº”å…ƒç»„æå–å™¨
â”‚   â”œâ”€â”€ quintuple_graph.py      # Neo4jå›¾è°±æ“ä½œ
â”‚   â”œâ”€â”€ quintuple_rag_query.py  # è®°å¿†æŸ¥è¯¢
â”‚   â””â”€â”€ quintuple_visualize_v2.py  # å›¾è°±å¯è§†åŒ–
â”œâ”€â”€ logs/                       # æ—¥å¿—ï¼ˆå«å†å²txtå¯¹è¯ï¼‰
â”œâ”€â”€ voice/                      # è¯­éŸ³ç›¸å…³
â”‚   â”œâ”€â”€ tts_handler.py          # TTSå¤„ç†å™¨
â”‚   â””â”€â”€ voice_integration.py    # è¯­éŸ³é›†æˆ
â”œâ”€â”€ ui/                         # å‰ç«¯UI
â”‚   â”œâ”€â”€ pyqt_chat_window.py     # PyQtèŠå¤©çª—å£
â”‚   â”œâ”€â”€ response_utils.py       # å‰ç«¯é€šç”¨å“åº”è§£æå·¥å…·
â”‚   â””â”€â”€ tray/                   # ç³»ç»Ÿæ‰˜ç›˜æ¨¡å—
â”‚       â”œâ”€â”€ console_tray.py     # æ§åˆ¶å°æ‰˜ç›˜åŠŸèƒ½
â”‚       â”œâ”€â”€ auto_start.py       # è‡ªå¯åŠ¨ç®¡ç†
â”‚       â””â”€â”€ README.md           # æ‰˜ç›˜ä½¿ç”¨è¯´æ˜
â””â”€â”€ README.md                   # é¡¹ç›®è¯´æ˜
```

---

## ğŸ”§ å·¥å…·è°ƒç”¨å¾ªç¯æœºåˆ¶

### ç³»ç»Ÿæ¦‚è¿°
NagaAgentæ”¯æŒä¸¤ç§ç±»å‹çš„å·¥å…·è°ƒç”¨ï¼š
- **MCPæœåŠ¡è°ƒç”¨**: é€šè¿‡`agentType: mcp`è°ƒç”¨MCPç±»å‹çš„Agent
- **AgentæœåŠ¡è°ƒç”¨**: é€šè¿‡`agentType: agent`è°ƒç”¨Agentç±»å‹çš„Agent

### å·¥å…·è°ƒç”¨æ ¼å¼

#### MCPæœåŠ¡è°ƒç”¨æ ¼å¼
```json
{
  "agentType": "mcp",
  "service_name": "MCPæœåŠ¡åç§°",
  "tool_name": "å·¥å…·åç§°",
  "å‚æ•°å": "å‚æ•°å€¼"
}
```

#### AgentæœåŠ¡è°ƒç”¨æ ¼å¼
```json
{
  "agentType": "agent",
  "agent_name": "Agentåç§°",
  "prompt": "ä»»åŠ¡å†…å®¹"
}
```

### å·¥å…·è°ƒç”¨æµç¨‹
1. **LLMè¾“å‡ºJSONæ ¼å¼**: LLMæ ¹æ®ç”¨æˆ·éœ€æ±‚è¾“å‡ºå·¥å…·è°ƒç”¨è¯·æ±‚
2. **è‡ªåŠ¨è§£æagentType**: ç³»ç»Ÿé¦–å…ˆè§£æagentTypeå­—æ®µï¼Œç¡®å®šè°ƒç”¨ç±»å‹
3. **è·¯ç”±åˆ°å¯¹åº”ç®¡ç†å™¨**: 
   - `mcp`ç±»å‹ â†’ è·¯ç”±åˆ°MCPManagerå¤„ç†
   - `agent`ç±»å‹ â†’ è·¯ç”±åˆ°AgentManagerå¤„ç†
4. **æ‰§è¡Œå·¥å…·è°ƒç”¨**: è°ƒç”¨å¯¹åº”çš„æœåŠ¡æ‰§è¡Œå…·ä½“ä»»åŠ¡
5. **ç»“æœè¿”å›LLM**: å°†å·¥å…·æ‰§è¡Œç»“æœè¿”å›ç»™LLM
6. **å¾ªç¯å¤„ç†**: é‡å¤æ­¥éª¤2-5ï¼Œç›´åˆ°LLMè¾“å‡ºæ™®é€šæ–‡æœ¬æˆ–æ— å·¥å…·è°ƒç”¨

### é…ç½®å‚æ•°
```python
# config.pyä¸­çš„å·¥å…·è°ƒç”¨å¾ªç¯é…ç½®
MAX_handoff_LOOP_STREAM = 5      # æµå¼æ¨¡å¼æœ€å¤§å·¥å…·è°ƒç”¨å¾ªç¯æ¬¡æ•°
MAX_handoff_LOOP_NON_STREAM = 5  # éæµå¼æ¨¡å¼æœ€å¤§å·¥å…·è°ƒç”¨å¾ªç¯æ¬¡æ•°
SHOW_handoff_OUTPUT = False      # æ˜¯å¦æ˜¾ç¤ºå·¥å…·è°ƒç”¨è¾“å‡º
```

---

## ğŸŒ å¤šAgentä¸MCPæœåŠ¡

### åŠ¨æ€æœåŠ¡æ± æŸ¥è¯¢åŠŸèƒ½

#### æ ¸å¿ƒæŸ¥è¯¢æ–¹æ³•
```python
from mcpserver.mcp_registry import (
    get_all_services_info,      # è·å–æ‰€æœ‰æœåŠ¡ä¿¡æ¯
    get_service_info,           # è·å–å•ä¸ªæœåŠ¡è¯¦æƒ…
    query_services_by_capability, # æŒ‰èƒ½åŠ›æœç´¢æœåŠ¡
    get_service_statistics,     # è·å–ç»Ÿè®¡ä¿¡æ¯
    get_available_tools         # è·å–æœåŠ¡å·¥å…·åˆ—è¡¨
)
```

#### APIç«¯ç‚¹
- `GET /mcp/services` - è·å–æ‰€æœ‰æœåŠ¡åˆ—è¡¨å’Œç»Ÿè®¡ä¿¡æ¯
- `GET /mcp/services/{service_name}` - è·å–æŒ‡å®šæœåŠ¡è¯¦æƒ…
- `GET /mcp/services/search/{capability}` - æŒ‰èƒ½åŠ›æœç´¢æœåŠ¡
- `GET /mcp/services/{service_name}/tools` - è·å–æœåŠ¡å·¥å…·åˆ—è¡¨
- `GET /mcp/statistics` - è·å–æœåŠ¡ç»Ÿè®¡ä¿¡æ¯

### å…¸å‹ç”¨æ³•ç¤ºä¾‹
```python
# è¯»å–æ–‡ä»¶å†…å®¹
await s.mcp.handoff(
  service_name="file",
  task={"action": "read", "path": "test.txt"}
)

# è¿è¡ŒPythonä»£ç 
await s.mcp.handoff(
  service_name="coder",
  task={"action": "run", "file": "main.py"}
)
```

---

## ğŸ¤– AgentManager ç‹¬ç«‹ç³»ç»Ÿ

### ç³»ç»Ÿæ¦‚è¿°
AgentManageræ˜¯ä¸€ä¸ªç‹¬ç«‹çš„Agentæ³¨å†Œå’Œè°ƒç”¨ç³»ç»Ÿï¼Œæ”¯æŒä»é…ç½®æ–‡ä»¶åŠ¨æ€åŠ è½½Agentå®šä¹‰ï¼Œæä¾›ç»Ÿä¸€çš„è°ƒç”¨æ¥å£å’Œå®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€‚

### æ ¸å¿ƒåŠŸèƒ½

#### 1. é…ç½®ç®¡ç†
- **åŠ¨æ€é…ç½®åŠ è½½**: ä»`agent_configs/`ç›®å½•è‡ªåŠ¨æ‰«æå’ŒåŠ è½½Agenté…ç½®æ–‡ä»¶
- **é…ç½®éªŒè¯**: è‡ªåŠ¨éªŒè¯Agenté…ç½®çš„å®Œæ•´æ€§å’Œæœ‰æ•ˆæ€§
- **çƒ­é‡è½½**: æ”¯æŒè¿è¡Œæ—¶é‡æ–°åŠ è½½é…ç½®ï¼Œæ— éœ€é‡å¯ç³»ç»Ÿ
- **ç¯å¢ƒå˜é‡æ”¯æŒ**: æ”¯æŒä»ç¯å¢ƒå˜é‡å’Œ`.env`æ–‡ä»¶åŠ è½½æ•æ„Ÿé…ç½®

#### 2. ä¼šè¯ç®¡ç†
- **å¤šä¼šè¯æ”¯æŒ**: æ¯ä¸ªAgentæ”¯æŒå¤šä¸ªç‹¬ç«‹çš„ä¼šè¯ä¸Šä¸‹æ–‡
- **å†å²è®°å½•**: è‡ªåŠ¨ç»´æŠ¤å¯¹è¯å†å²ï¼Œæ”¯æŒä¸Šä¸‹æ–‡å¬å›
- **ä¼šè¯è¿‡æœŸ**: è‡ªåŠ¨æ¸…ç†è¿‡æœŸçš„ä¼šè¯æ•°æ®ï¼ŒèŠ‚çœå†…å­˜
- **ä¼šè¯éš”ç¦»**: ä¸åŒç”¨æˆ·å’Œä¸åŒAgentçš„ä¼šè¯å®Œå…¨éš”ç¦»

#### 3. æ™ºèƒ½å ä½ç¬¦æ›¿æ¢
æ”¯æŒå¤šç§ç±»å‹çš„å ä½ç¬¦æ›¿æ¢ï¼š

**Agenté…ç½®å ä½ç¬¦**:
- `{{AgentName}}` - Agentåç§°
- `{{Description}}` - æè¿°ä¿¡æ¯
- `{{ModelId}}` - æ¨¡å‹ID
- `{{Temperature}}` - æ¸©åº¦å‚æ•°
- `{{MaxTokens}}` - æœ€å¤§è¾“å‡ºtokenæ•°
- `{{ModelProvider}}` - æ¨¡å‹æä¾›å•†

**ç¯å¢ƒå˜é‡å ä½ç¬¦**:
- `{{ENV_VAR_NAME}}` - ç³»ç»Ÿç¯å¢ƒå˜é‡

**æ—¶é—´å ä½ç¬¦**:
- `{{CurrentTime}}` - å½“å‰æ—¶é—´ (HH:MM:SS)
- `{{CurrentDate}}` - å½“å‰æ—¥æœŸ (YYYY-MM-DD)
- `{{CurrentDateTime}}` - å®Œæ•´æ—¶é—´ (YYYY-MM-DD HH:MM:SS)

### é…ç½®æ–‡ä»¶æ ¼å¼

#### Agenté…ç½®æ–‡ä»¶ç¤ºä¾‹
```json
{
  "ExampleAgent": {
    "model_id": "deepseek-chat",
    "name": "ç¤ºä¾‹åŠ©æ‰‹",
    "base_name": "ExampleAgent",
    "system_prompt": "ä½ æ˜¯{{AgentName}}ï¼Œä¸€ä¸ªä¸“ä¸šçš„{{Description}}ã€‚\n\nå½“å‰æ—¶é—´ï¼š{{CurrentDateTime}}\næ¨¡å‹ï¼š{{ModelId}}\næ¸©åº¦ï¼š{{Temperature}}\n\nè¯·ç”¨ä¸­æ–‡å›ç­”ï¼Œä¿æŒä¸“ä¸šå’Œå‹å¥½çš„æ€åº¦ã€‚",
    "max_output_tokens": 8192,
    "temperature": 0.7,
    "description": "æ™ºèƒ½åŠ©æ‰‹ï¼Œæ“…é•¿å›ç­”å„ç§é—®é¢˜",
    "model_provider": "openai",
    "api_base_url": "https://api.deepseek.com/v1",
    "api_key": "{{DEEPSEEK_API_KEY}}"
  }
}
```

### ä½¿ç”¨ç¤ºä¾‹

#### åŸºæœ¬è°ƒç”¨
```python
from mcpserver.agent_manager import get_agent_manager

# è·å–AgentManagerå®ä¾‹
agent_manager = get_agent_manager()

# è°ƒç”¨Agent
result = await agent_manager.call_agent(
    agent_name="ExampleAgent",
    prompt="è¯·å¸®æˆ‘åˆ†æè¿™ä»½æ•°æ®",
    session_id="user_123"
)
```

#### ä¾¿æ·å‡½æ•°è°ƒç”¨
```python
from mcpserver.agent_manager import call_agent, list_agents, get_agent_info

# ä¾¿æ·è°ƒç”¨
result = await call_agent("ExampleAgent", "ä½ å¥½")

# è·å–Agentåˆ—è¡¨
agents = list_agents()
```

---

## ğŸ“‹ Agent Manifestæ ‡å‡†åŒ–

### æ ‡å‡†åŒ–è§„èŒƒ
æ‰€æœ‰Agentå¿…é¡»ä½¿ç”¨æ ‡å‡†åŒ–çš„`agent-manifest.json`é…ç½®æ–‡ä»¶ï¼Œç¡®ä¿ä¸€è‡´æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

#### å¿…éœ€å­—æ®µ
- `name`: Agentå”¯ä¸€æ ‡è¯†ç¬¦
- `displayName`: æ˜¾ç¤ºåç§°
- `version`: ç‰ˆæœ¬å·ï¼ˆx.y.zæ ¼å¼ï¼‰
- `description`: åŠŸèƒ½æè¿°
- `author`: ä½œè€…æˆ–æ¨¡å—åç§°
- `agentType`: Agentç±»å‹ï¼ˆmcp/agentï¼‰
- `entryPoint`: å…¥å£ç‚¹é…ç½®ï¼ˆmoduleå’Œclassï¼‰

### åˆ›å»ºæ–°Agent

#### åˆ›å»ºMCPç±»å‹Agent
1. åœ¨`mcpserver/`ç›®å½•ä¸‹åˆ›å»ºæ–°çš„Agentç›®å½•
2. å¤åˆ¶`AGENT_MANIFEST_TEMPLATE.json`åˆ°Agentç›®å½•
3. ä¿®æ”¹manifestæ–‡ä»¶å†…å®¹
4. åˆ›å»ºAgentå®ç°ç±»
5. é‡å¯ç³»ç»Ÿè‡ªåŠ¨æ³¨å†Œ

#### åˆ›å»ºAgentç±»å‹Agent
1. åœ¨`agent_configs/`ç›®å½•ä¸‹åˆ›å»ºé…ç½®æ–‡ä»¶
2. å®šä¹‰Agenté…ç½®ï¼ˆæ¨¡å‹ã€æç¤ºè¯ç­‰ï¼‰
3. é…ç½®ç¯å¢ƒå˜é‡ï¼ˆAPIå¯†é’¥ç­‰ï¼‰
4. é‡å¯ç³»ç»Ÿè‡ªåŠ¨åŠ è½½

---

## ğŸ–¥ï¸ ç³»ç»Ÿæ‰˜ç›˜åŠŸèƒ½

### åŠŸèƒ½ç‰¹æ€§
- **æ§åˆ¶å°æ‰˜ç›˜**: å°†ç»ˆç«¯çª—å£éšè—åˆ°ç³»ç»Ÿæ‰˜ç›˜ï¼Œæ”¯æŒè‡ªåŠ¨éšè—
- **ä»»åŠ¡æ éšè—**: æ§åˆ¶å°çª—å£ä»ä»»åŠ¡æ å®Œå…¨éšè—
- **æ‰˜ç›˜å›¾æ ‡**: ç³»ç»Ÿæ‰˜ç›˜æ˜¾ç¤ºåº”ç”¨å›¾æ ‡ï¼Œæ”¯æŒå³é”®èœå•
- **è‡ªå¯åŠ¨ç®¡ç†**: æ”¯æŒæ³¨å†Œè¡¨æ–¹å¼çš„è‡ªå¯åŠ¨åŠŸèƒ½
- **æ‰˜ç›˜æ¶ˆæ¯**: æ”¯æŒçŠ¶æ€é€šçŸ¥å’Œæ¶ˆæ¯æç¤º

### ä½¿ç”¨æ–¹æ³•

#### æ‰˜ç›˜æ¨¡å¼å¯åŠ¨
```bash
# Windows
.\start_with_tray.bat
```

#### æ‰˜ç›˜èœå•åŠŸèƒ½
- **æ˜¾ç¤ºæ§åˆ¶å°**: ä»æ‰˜ç›˜æ¢å¤æ§åˆ¶å°çª—å£æ˜¾ç¤º
- **éšè—æ§åˆ¶å°**: éšè—æ§åˆ¶å°çª—å£åˆ°æ‰˜ç›˜
- **å¼€æœºè‡ªå¯åŠ¨**: åˆ‡æ¢è‡ªå¯åŠ¨çŠ¶æ€
- **é€€å‡º**: å®Œå…¨é€€å‡ºåº”ç”¨

### æŠ€æœ¯å®ç°
- **çª—å£é’©å­**: ç›‘å¬æ§åˆ¶å°çª—å£çš„å…³é—­äº‹ä»¶ï¼Œæ‹¦æˆªå…³é—­æ“ä½œ
- **çª—å£æ ·å¼**: ä½¿ç”¨`WS_EX_TOOLWINDOW`æ ·å¼è®©çª—å£ä¸åœ¨ä»»åŠ¡æ æ˜¾ç¤º
- **è‡ªåŠ¨éšè—**: å¯åŠ¨å3ç§’è‡ªåŠ¨éšè—æ§åˆ¶å°çª—å£
- **æ‰˜ç›˜é›†æˆ**: ä½¿ç”¨PyQt5å®ç°ç³»ç»Ÿæ‰˜ç›˜åŠŸèƒ½

### æ³¨æ„äº‹é¡¹
1. **æƒé™è¦æ±‚**: è‡ªå¯åŠ¨åŠŸèƒ½éœ€è¦ç®¡ç†å‘˜æƒé™
2. **ä¾èµ–å®‰è£…**: éœ€è¦å®‰è£…`PyQt5`åº“
3. **å›¾æ ‡æ–‡ä»¶**: é»˜è®¤ä½¿ç”¨`ui/window_icon.png`ä½œä¸ºæ‰˜ç›˜å›¾æ ‡
4. **å¯åŠ¨æ–¹å¼**: ä½¿ç”¨`start_with_tray.bat`å¯åŠ¨ä»¥å¯ç”¨æ‰˜ç›˜åŠŸèƒ½

---

## ğŸŒ RESTful API æœåŠ¡

NagaAgentå†…ç½®å®Œæ•´çš„RESTful APIæœåŠ¡å™¨ï¼Œå¯åŠ¨æ—¶è‡ªåŠ¨å¼€å¯ï¼Œæ”¯æŒæ‰€æœ‰å¯¹è¯åŠŸèƒ½ï¼š

### APIæ¥å£è¯´æ˜

- **åŸºç¡€åœ°å€**: `http://127.0.0.1:8000` (å¯åœ¨config.pyä¸­é…ç½®)
- **äº¤äº’å¼æ–‡æ¡£**: `http://127.0.0.1:8000/docs`
- **OpenAPIè§„èŒƒ**: `http://127.0.0.1:8000/openapi.json`

### ä¸»è¦æ¥å£

#### å¥åº·æ£€æŸ¥
```bash
GET /health
```

#### å¯¹è¯æ¥å£
```bash
# æ™®é€šå¯¹è¯
POST /chat
{
  "message": "ä½ å¥½ï¼Œå¨œè¿¦",
  "session_id": "optional-session-id"
}

# æµå¼å¯¹è¯ (Server-Sent Events)
POST /chat/stream
{
  "message": "è¯·ä»‹ç»ä¸€ä¸‹äººå·¥æ™ºèƒ½çš„å‘å±•å†ç¨‹"
}
```

#### ç³»ç»Ÿç®¡ç†æ¥å£
```bash
# è·å–ç³»ç»Ÿä¿¡æ¯
GET /system/info

# åˆ‡æ¢å¼€å‘è€…æ¨¡å¼
POST /system/devmode

# è·å–è®°å¿†ç»Ÿè®¡
GET /memory/stats
```

## MCPæœåŠ¡AgentåŒ–å‡çº§è¯´æ˜

- æ‰€æœ‰MCPæœåŠ¡ï¼ˆå¦‚æ–‡ä»¶ã€ä»£ç ã€æµè§ˆå™¨ã€åº”ç”¨å¯åŠ¨ã€ç³»ç»Ÿæ§åˆ¶ã€å¤©æ°”ç­‰ï¼‰å·²å…¨éƒ¨å‡çº§ä¸ºæ ‡å‡†Agenté£æ ¼ï¼š
  - ç»Ÿä¸€ç»§æ‰¿è‡ª`agents.Agent`ï¼Œå…·å¤‡`name`ã€`instructions`å±æ€§å’Œ`handle_handoff`å¼‚æ­¥æ–¹æ³•
  - å˜é‡å…¨éƒ¨èµ°`config.py`ç»Ÿä¸€ç®¡ç†ï¼Œé¿å…é‡å¤å®šä¹‰
  - æ³¨é‡Šå…¨éƒ¨ä¸­æ–‡ï¼Œæ–‡ä»¶/ç±»/å‡½æ•°æ³¨é‡Šä¸€è¡Œï¼Œå˜é‡æ³¨é‡Šå³ä¾§#
  - æ”¯æŒå¤šagentåä½œï¼ŒControllerAgentå¯æ™ºèƒ½åˆ†é…ä»»åŠ¡ç»™BrowserAgentã€ContentAgentç­‰
  - æ³¨å†Œä¸­å¿ƒ`mcp_registry.py`è‡ªåŠ¨å‘ç°å¹¶æ³¨å†Œæ‰€æœ‰å®ç°äº†`handle_handoff`çš„Agentå®ä¾‹ï¼Œæ”¯æŒçƒ­æ’æ‹”
  - æ³¨å†Œæ—¶è‡ªåŠ¨è¾“å‡ºæ‰€æœ‰å·²æ³¨å†Œagentçš„åç§°å’Œè¯´æ˜ï¼Œä¾¿äºè°ƒè¯•
  - ç®€åŒ–Agentç±»å‹ï¼šåªæ”¯æŒ`mcp`å’Œ`agent`ä¸¤ç§ç±»å‹

- handoffæœºåˆ¶å…¨éƒ¨é€šè¿‡`handle_handoff`å¼‚æ­¥æ–¹æ³•è°ƒåº¦ï¼Œå…¼å®¹JSONå’Œhandoffä¸¤ç§æ ¼å¼

- æ–°å¢/åˆ é™¤agentåªéœ€å¢åˆ pyæ–‡ä»¶ï¼Œæ— éœ€é‡å¯ä¸»ç¨‹åº

- è¯¦ç»†æ¥å£å’Œå‚æ•°è¯·å‚è€ƒå„Agentä»£ç æ³¨é‡Šä¸`config.py`é…ç½® 

## æ›´æ–°æ—¥å¿—

- å·¥å…·è°ƒç”¨æ ¼å¼å·²ä¼˜åŒ–ï¼Œæ”¹ä¸ºçº¯JSONæ ¼å¼ï¼Œæ›´åŠ ç®€æ´è§„èŒƒï¼Œå…·ä½“ç¤ºä¾‹å¦‚ä¸‹ï¼š

```
{
  "agentType": "mcp",
  "service_name": "MCPæœåŠ¡åç§°",
  "tool_name": "å·¥å…·åç§°",
  "å‚æ•°å": "å‚æ•°å€¼"
}
```

---

## ğŸ“ å‰ç«¯UIä¸å“åº”é€‚é…
- **æ‰€æœ‰åç«¯è¿”å›å‡ä¸ºç»“æ„åŒ–JSON**: å‰ç«¯é€šè¿‡`ui/response_utils.py`çš„`extract_message`æ–¹æ³•è‡ªåŠ¨é€‚é…å¤šç§è¿”å›æ ¼å¼
- **ä¼˜å…ˆæ˜¾ç¤ºé€»è¾‘**: ä¼˜å…ˆæ˜¾ç¤º`data.content`ï¼Œå…¶æ¬¡`message`ï¼Œæœ€ååŸæ ·è¿”å›ï¼Œå…¼å®¹æ‰€æœ‰Agent
- **æ¢è¡Œç¬¦è‡ªåŠ¨é€‚é…**: PyQtå‰ç«¯è‡ªåŠ¨å°†æ‰€æœ‰`\n`å’Œ`\\n`æ¢è¡Œç¬¦è½¬ä¸º`<br>`ï¼Œå¤šè¡Œå†…å®¹æ˜¾ç¤ºæ— éšœç¢
- **UIåŠ¨ç”»**: ä¾§æ ç‚¹å‡»åˆ‡æ¢æ—¶ï¼Œä¾§æ å®½åº¦ã€ä¸»èŠå¤©åŒºå®½åº¦ã€è¾“å…¥æ¡†é«˜åº¦å‡é‡‡ç”¨åŒæ­¥åŠ¨ç”»
- **ä¸»é¢˜è‡ªå®šä¹‰**: UIåŠ¨ç”»ã€ä¸»é¢˜ã€æ˜µç§°ã€é€æ˜åº¦ç­‰å…¨éƒ¨å¯åœ¨`config.py`å’Œ`pyqt_chat_window.py`çµæ´»é…ç½®

---

## ğŸ”Š æµå¼è¯­éŸ³äº¤äº’
- **æ”¯æŒè¯­éŸ³è¾“å…¥**: æµå¼è¯†åˆ«ï¼Œè‡ªåŠ¨è½¬æ–‡å­—
- **æ”¯æŒè¯­éŸ³è¾“å‡º**: æµå¼åˆæˆï¼Œè¾¹æ’­è¾¹å‡º
- **å®Œå…¨å¼‚æ­¥å¤„ç†**: é‡æ„è¯­éŸ³é›†æˆç³»ç»Ÿï¼Œæ–‡æœ¬æ˜¾ç¤ºå’ŒéŸ³é¢‘æ’­æ”¾å®Œå…¨åˆ†ç¦»
- **æ¶ˆé™¤é‡å¤æ’­æ”¾**: ç§»é™¤æµå¼åˆ†å¥å’Œæœ€ç»ˆæ–‡æœ¬çš„é‡å¤æ’­æ”¾é—®é¢˜
- **å‰ç«¯å³æ—¶æ˜¾ç¤º**: å‰ç«¯ç«‹å³æ˜¾ç¤ºæ–‡æœ¬ï¼Œä¸å†ç­‰å¾…éŸ³é¢‘å¤„ç†å®Œæˆ
- **ä¾èµ–ä¸é…ç½®**: è¯¦è§`voice/voice_config.py`å’ŒREADMEç›¸å…³ç« èŠ‚

---

## ğŸ“ å…¶å®ƒäº®ç‚¹
- **è®°å¿†æƒé‡åŠ¨æ€è°ƒæ•´**: æ”¯æŒAI/äººå·¥æ ‡è®°importantï¼Œæƒé‡/é˜ˆå€¼/æ¸…ç†ç­–ç•¥å…¨éƒ¨åœ¨`config.py`ç»Ÿä¸€ç®¡ç†
- **ä¸»é¢˜å½’ç±»è‡ªåŠ¨åŒ–**: ä¸»é¢˜å½’ç±»ã€å¬å›ã€æƒé‡æå‡ã€æ¸…ç†ç­‰å…¨éƒ¨è‡ªåŠ¨åŒ–
- **æ£€ç´¢æ—¥å¿—è‡ªåŠ¨è®°å½•**: å‚æ•°å¯è°ƒï¼ŒGRAGé…ç½®ç¤ºä¾‹è§`config.py`
- **å†å²å¯¹è¯å…¼å®¹å‡çº§**: æ”¯æŒå°†æ—§ç‰ˆtxtå¯¹è¯å†…å®¹ä¸€é”®å¯¼å…¥GRAGçŸ¥è¯†å›¾è°±è®°å¿†ç³»ç»Ÿ
- **å·¥å…·è°ƒç”¨å¾ªç¯è‡ªåŠ¨æ‰§è¡Œæœºåˆ¶**: æ”¯æŒå¤šè½®é€’å½’è°ƒç”¨ï¼Œæœ€å¤§å¾ªç¯æ¬¡æ•°å¯é…ç½®
- **æ‰€æœ‰Agentçš„æ³¨å†Œå…ƒæ•°æ®å·²é›†ä¸­åœ¨`mcpserver/mcp_registry.py`**: ä¸»æµç¨‹å’Œç®¡ç†å™¨æç®€ï¼Œæ‰©å±•ç»´æŠ¤æ›´æ–¹ä¾¿
- **è‡ªåŠ¨æ³¨å†Œ/çƒ­æ’æ‹”Agentæœºåˆ¶**: æ–°å¢/åˆ é™¤Agentåªéœ€å¢åˆ pyæ–‡ä»¶ï¼Œæ— éœ€é‡å¯ä¸»ç¨‹åº
- **Agent Manifestæ ‡å‡†åŒ–**: ç»Ÿä¸€çš„`agent-manifest.json`æ ¼å¼ï¼Œæ”¯æŒå®Œæ•´çš„å­—æ®µéªŒè¯å’Œç±»å‹æ£€æŸ¥
- **åŠ¨æ€æœåŠ¡æ± æŸ¥è¯¢**: ç³»ç»Ÿé€šè¿‡æ‰«æ`agent-manifest.json`æ–‡ä»¶è‡ªåŠ¨å‘ç°å’Œæ³¨å†ŒæœåŠ¡ï¼Œæ— éœ€æ‰‹åŠ¨é…ç½®é™æ€æœåŠ¡åˆ—è¡¨
- **AgentManagerç‹¬ç«‹ç³»ç»Ÿ**: æ”¯æŒAgentçš„é…ç½®åŠ è½½ã€ä¼šè¯ç®¡ç†ã€æ¶ˆæ¯ç»„è£…å’ŒLLMè°ƒç”¨ï¼Œæä¾›å®Œæ•´çš„Agentç”Ÿå‘½å‘¨æœŸç®¡ç†
- **æ™ºèƒ½å ä½ç¬¦æ›¿æ¢**: æ”¯æŒAgenté…ç½®ã€ç¯å¢ƒå˜é‡ã€æ—¶é—´ä¿¡æ¯ç­‰å¤šç§å ä½ç¬¦ï¼Œå®ç°åŠ¨æ€æç¤ºè¯ç”Ÿæˆ
- **å®Œæ•´æ¶ˆæ¯åºåˆ—æ„å»º**: è‡ªåŠ¨ç»„è£…ç³»ç»Ÿæ¶ˆæ¯ã€å†å²æ¶ˆæ¯å’Œç”¨æˆ·æ¶ˆæ¯ï¼Œç¡®ä¿å¯¹è¯ä¸Šä¸‹æ–‡å®Œæ•´æ€§
- **å¤šæ¨¡å‹æä¾›å•†æ”¯æŒ**: æ”¯æŒOpenAIã€DeepSeekã€Anthropicç­‰å¤šç§LLMæä¾›å•†ï¼Œæ¯ä¸ªAgentå¯ç‹¬ç«‹é…ç½®
- **ä¼šè¯éš”ç¦»ä¸TTLç®¡ç†**: æ”¯æŒå¤šç”¨æˆ·å¤šä¼šè¯éš”ç¦»ï¼Œè‡ªåŠ¨æ¸…ç†è¿‡æœŸä¼šè¯æ•°æ®
- **ç»Ÿä¸€å·¥å…·è°ƒç”¨æ¥å£**: MCPå’ŒAgentç±»å‹æœåŠ¡é€šè¿‡ç»Ÿä¸€çš„JSONæ ¼å¼è°ƒç”¨ï¼Œæ”¯æŒæ··åˆè°ƒç”¨åœºæ™¯

---

## ğŸ†™ å†å²å¯¹è¯å…¼å®¹å‡çº§
- **æ”¯æŒå°†æ—§ç‰ˆtxtå¯¹è¯å†…å®¹ä¸€é”®å¯¼å…¥GRAGçŸ¥è¯†å›¾è°±è®°å¿†ç³»ç»Ÿ**: å…¼å®¹ä¸»é¢˜ã€åˆ†å±‚ã€äº”å…ƒç»„ç­‰æ‰€æœ‰æ–°ç‰¹æ€§
- **æ¿€æ´»æŒ‡ä»¤**:
  ```
  #å¤å›­ç³»ç»Ÿå…¼å®¹å‡çº§
  ```
- **ç³»ç»Ÿä¼šè‡ªåŠ¨éå†logsç›®å½•ä¸‹æ‰€æœ‰txtæ—¥å¿—**: åˆ—å‡ºæ‰€æœ‰å†å²å¯¹è¯å†…å®¹å¹¶ç¼–å·ï¼Œè¾“å‡ºåˆ°ç»ˆç«¯å’Œ`summer_memory/history_dialogs.json`
- **ç”¨æˆ·å¯æŸ¥çœ‹ç¼–å·åï¼Œé€‰æ‹©å¯¼å…¥æ–¹å¼**:
  - å…¨éƒ¨å¯¼å…¥ï¼š
    ```
    python summer_memory/main.py import all
    ```
  - é€‰æ‹©æ€§å¯¼å…¥ï¼ˆå¦‚ç¬¬1ã€3ã€5-8æ¡ï¼‰ï¼š
    ```
    python summer_memory/main.py import 1,3,5-8
    ```
- **å…¼å®¹è¿‡ç¨‹è‡ªåŠ¨åˆ¤é‡**: å·²å…¥åº“å†…å®¹ä¸ä¼šé‡å¤å¯¼å…¥ï¼Œæ”¯æŒæ–­ç‚¹ç»­è·‘
- **å…¼å®¹å†…å®¹å…¨éƒ¨èµ°AIè‡ªåŠ¨ä¸»é¢˜å½’ç±»ä¸åˆ†å±‚**: å®Œå…¨ä¸æ–°ç³»ç»Ÿä¸€è‡´
- **è¯¦ç»†è¿›åº¦ã€ç»“æœå’Œå¼‚å¸¸å‡æœ‰åé¦ˆ**: å®‰å…¨é«˜æ•ˆ

---

## ğŸ”§ æœ€æ–°æ›´æ–° (v3.0.5)

### ç³»ç»Ÿæ‰˜ç›˜åŠŸèƒ½å¢å¼º
- **æ§åˆ¶å°æ‰˜ç›˜åŠŸèƒ½**: å®ç°çœŸæ­£çš„"æœ€å°åŒ–åˆ°æ‰˜ç›˜"åŠŸèƒ½
- **çª—å£é’©å­**: ç›‘å¬æ§åˆ¶å°çª—å£çš„å…³é—­äº‹ä»¶ï¼Œæ‹¦æˆªå…³é—­æ“ä½œ
- **ä»»åŠ¡æ éšè—**: ä½¿ç”¨`WS_EX_TOOLWINDOW`æ ·å¼è®©çª—å£ä¸åœ¨ä»»åŠ¡æ æ˜¾ç¤º
- **è‡ªåŠ¨éšè—**: å¯åŠ¨å3ç§’è‡ªåŠ¨éšè—æ§åˆ¶å°çª—å£
- **æ‰˜ç›˜æ¶ˆæ¯**: æ”¯æŒæ‰˜ç›˜æ¶ˆæ¯é€šçŸ¥å’ŒçŠ¶æ€æç¤º

### MCPå·¥å…·ä¾èµ–
- **æ–°å¢ä¾èµ–**: æ·»åŠ `jmcomic`å’Œ`fastmcp`ä¾èµ–åˆ°`requirements.txt`
- **è™šæ‹Ÿç¯å¢ƒå®‰è£…**: ç¡®ä¿ä¾èµ–å®‰è£…åˆ°è™šæ‹Ÿç¯å¢ƒä¸­
- **ä¾èµ–éªŒè¯**: æä¾›ä¾èµ–å®‰è£…éªŒè¯è„šæœ¬

### æŠ€æœ¯æ”¹è¿›
- **çª—å£ç›‘æ§**: æ·»åŠ çª—å£çŠ¶æ€ç›‘æ§çº¿ç¨‹ï¼Œå®æ—¶æ£€æµ‹çª—å£æ˜¾ç¤º/éšè—çŠ¶æ€
- **æ ·å¼ç®¡ç†**: ä¿å­˜å’Œæ¢å¤åŸå§‹çª—å£æ ·å¼ï¼Œç¡®ä¿åŠŸèƒ½ç¨³å®šæ€§
- **é”™è¯¯å¤„ç†**: å¢å¼ºçª—å£æ“ä½œå’Œæ‰˜ç›˜åŠŸèƒ½çš„é”™è¯¯å¤„ç†æœºåˆ¶

---

## â“ å¸¸è§é—®é¢˜

### ç¯å¢ƒæ£€æŸ¥
```bash
python check_env.py
```
### Windows ç¯å¢ƒ
- **Pythonç‰ˆæœ¬/ä¾èµ–/è™šæ‹Ÿç¯å¢ƒ/æµè§ˆå™¨é©±åŠ¨ç­‰é—®é¢˜**: è¯¦è§`setup.ps1`ä¸æœ¬README
- **IDEæŠ¥importé”™è¯¯**: é‡å¯å¹¶é€‰æ‹©æ­£ç¡®è§£é‡Šå™¨
- **è¯­éŸ³ä¾èµ–å®‰è£…å¤±è´¥**: å…ˆè£…C++ Build Tools
- **MCPå·¥å…·ä¾èµ–ç¼ºå¤±**: è¿è¡Œ`pip install jmcomic fastmcp`

### Mac ç¯å¢ƒ
- **Pythonç‰ˆæœ¬è¿‡ä½**: `brew install python@3.11`
- **PyAudioå®‰è£…å¤±è´¥**: `brew install portaudio && pip install pyaudio`
- **æƒé™é—®é¢˜**: `chmod +x *.sh`

### APIæœåŠ¡å™¨é—®é¢˜
- **ç«¯å£å ç”¨**: ä¿®æ”¹`config.py`ä¸­çš„`API_SERVER_PORT`
- **ä»£ç†å¹²æ‰°**: ä¸´æ—¶ç¦ç”¨ä»£ç† `unset ALL_PROXY http_proxy https_proxy`
- **ä¾èµ–ç¼ºå¤±**: ç¡®ä¿å®‰è£…äº†FastAPIå’ŒUvicorn `pip install fastapi uvicorn[standard]`
- **æ— æ³•è®¿é—®**: æ£€æŸ¥é˜²ç«å¢™è®¾ç½®ï¼Œç¡®ä¿ç«¯å£æœªè¢«é˜»å¡

### å·¥å…·è°ƒç”¨é—®é¢˜
- **å·¥å…·è°ƒç”¨å¾ªç¯æ¬¡æ•°è¿‡å¤š**: è°ƒæ•´`config.py`ä¸­çš„`MAX_handoff_LOOP_STREAM`å’Œ`MAX_handoff_LOOP_NON_STREAM`
- **å·¥å…·è°ƒç”¨å¤±è´¥**: æ£€æŸ¥MCPæœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œï¼ŒæŸ¥çœ‹æ—¥å¿—è¾“å‡º
- **æ ¼å¼é”™è¯¯**: ç¡®ä¿LLMè¾“å‡ºä¸¥æ ¼éµå¾ªJSONæ ¼å¼

### GRAGè®°å¿†ç³»ç»Ÿé—®é¢˜
- **Neo4jè¿æ¥å¤±è´¥**: æ£€æŸ¥Neo4jæœåŠ¡æ˜¯å¦å¯åŠ¨ï¼Œç¡®è®¤è¿æ¥å‚æ•°æ­£ç¡®
- **è®°å¿†æŸ¥è¯¢æ— ç»“æœ**: æ£€æŸ¥äº”å…ƒç»„æ˜¯å¦æ­£ç¡®æå–å’Œå­˜å‚¨
- **æ€§èƒ½é—®é¢˜**: è°ƒæ•´`config.py`ä¸­çš„GRAGç›¸å…³å‚æ•°

### ç³»ç»Ÿæ‰˜ç›˜é—®é¢˜
- **æ‰˜ç›˜å›¾æ ‡ä¸æ˜¾ç¤º**: æ£€æŸ¥å›¾æ ‡æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œç¡®è®¤PyQt5å®‰è£…æ­£ç¡®
- **æ§åˆ¶å°æ‰˜ç›˜ä¸å·¥ä½œ**: ç¡®è®¤ä½¿ç”¨`start_with_tray.bat`å¯åŠ¨
- **è‡ªå¯åŠ¨å¤±è´¥**: ç¡®è®¤ç®¡ç†å‘˜æƒé™ï¼Œæ£€æŸ¥æ³¨å†Œè¡¨æƒé™
- **çª—å£æœ€å°åŒ–é—®é¢˜**: æ£€æŸ¥æ‰˜ç›˜é›†æˆæ˜¯å¦æ­£ç¡®ï¼Œç¡®è®¤äº‹ä»¶å¤„ç†å‡½æ•°

### AgentManageré—®é¢˜
- **Agenté…ç½®åŠ è½½å¤±è´¥**: æ£€æŸ¥`agent_configs/`ç›®å½•ä¸‹çš„JSONæ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®
- **APIè°ƒç”¨å¤±è´¥**: ç¡®è®¤APIå¯†é’¥é…ç½®æ­£ç¡®ï¼Œæ£€æŸ¥ç½‘ç»œè¿æ¥
- **ä¼šè¯å†å²ä¸¢å¤±**: æ£€æŸ¥ä¼šè¯TTLé…ç½®ï¼Œç¡®è®¤ä¼šè¯æœªè¿‡æœŸ
- **å ä½ç¬¦æ›¿æ¢å¤±è´¥**: ç¡®è®¤ç¯å¢ƒå˜é‡å·²æ­£ç¡®è®¾ç½®
- **å†…å­˜å ç”¨è¿‡é«˜**: è°ƒæ•´`max_history_rounds`å‚æ•°ï¼Œå‡å°‘å†å²æ¶ˆæ¯æ•°é‡

### é€šç”¨é—®é¢˜
- **æµè§ˆå™¨æ— æ³•å¯åŠ¨**: æ£€æŸ¥playwrightå®‰è£…ä¸ç½‘ç»œ
- **ä¸»é¢˜æ ‘/ç´¢å¼•/å‚æ•°/å¯†é’¥å…¨éƒ¨åœ¨`config.py`ç»Ÿä¸€ç®¡ç†**
- **èŠå¤©è¾“å…¥`#devmode`è¿›å…¥å¼€å‘è€…æ¨¡å¼**: åç»­å¯¹è¯ä¸å†™å…¥GRAGè®°å¿†ï¼Œä»…ç”¨äºå·¥å…·è°ƒç”¨æµ‹è¯•

### æœ€ä½³å®è·µ

#### Agenté…ç½®æœ€ä½³å®è·µ
1. **ä½¿ç”¨ç¯å¢ƒå˜é‡**: æ•æ„Ÿä¿¡æ¯å¦‚APIå¯†é’¥åº”ä½¿ç”¨ç¯å¢ƒå˜é‡
2. **åˆç†è®¾ç½®å‚æ•°**: æ ¹æ®ä»»åŠ¡éœ€æ±‚è°ƒæ•´temperatureå’Œmax_output_tokens
3. **ä¼˜åŒ–æç¤ºè¯**: ä½¿ç”¨å ä½ç¬¦å®ç°åŠ¨æ€å†…å®¹ï¼Œæé«˜çµæ´»æ€§
4. **ä¼šè¯ç®¡ç†**: åˆç†è®¾ç½®ä¼šè¯TTLï¼Œé¿å…å†…å­˜æ³„æ¼

#### æ€§èƒ½ä¼˜åŒ–å»ºè®®
1. **ç¼“å­˜é…ç½®**: å¯ç”¨é…ç½®ç¼“å­˜ï¼Œå‡å°‘æ–‡ä»¶è¯»å–å¼€é”€
2. **å¹¶å‘æ§åˆ¶**: åˆç†æ§åˆ¶å¹¶å‘Agentè°ƒç”¨æ•°é‡
3. **èµ„æºæ¸…ç†**: å®šæœŸæ¸…ç†è¿‡æœŸä¼šè¯å’Œä¸´æ—¶æ•°æ®
4. **ç›‘æ§æ—¥å¿—**: å¯ç”¨è°ƒè¯•æ¨¡å¼ç›‘æ§ç³»ç»Ÿæ€§èƒ½

#### å®‰å…¨å»ºè®®
1. **APIå¯†é’¥ç®¡ç†**: ä½¿ç”¨ç¯å¢ƒå˜é‡æˆ–å¯†é’¥ç®¡ç†æœåŠ¡
2. **è¾“å…¥éªŒè¯**: å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡ŒéªŒè¯å’Œæ¸…ç†
3. **é”™è¯¯å¤„ç†**: é¿å…åœ¨é”™è¯¯ä¿¡æ¯ä¸­æ³„éœ²æ•æ„Ÿä¿¡æ¯
4. **è®¿é—®æ§åˆ¶**: å®ç°é€‚å½“çš„è®¿é—®æ§åˆ¶æœºåˆ¶

---

## ğŸ“ è®¸å¯è¯
[MIT License](LICENSE)



> å¦‚éœ€è¯¦ç»†åŠŸèƒ½/API/æ‰©å±•è¯´æ˜ï¼Œè§å„æ¨¡å—æ³¨é‡Šä¸ä»£ç ã€‚
